{% extends "base.html" %}

{% block title %}Carrito de Compras - TecnoHub{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/carrito.css') }}">
    <h1>Carrito de Compras</h1>
    
    {% if carrito %}
        <form action="{{ url_for('actualizar_carrito') }}" method="post">
            <table>
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Precio</th>
                        <th>Cantidad</th>
                        <th>Subtotal</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in carrito %}
                        <tr>
                            <td>{{ item.nombre }}</td>
                            <td>${{ item.precio }}</td>
                            <td>
                                <input type="number" name="cantidad_{{ item.producto_id }}" value="{{ item.cantidad }}" min="1">
                            </td>
                            <td>${{ (item.precio * item.cantidad) | round(2) }}</td>
                            <td>
                                <button type="submit" name="eliminar" value="{{ item.producto_id }}" formaction="{{ url_for('eliminar_del_carrito', producto_id=item.producto_id) }}">Eliminar</button>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3"><strong>Total</strong></td>
                        <td><strong>${{ total | round(2) }}</strong></td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>
            <button type="submit">Actualizar Carrito</button>
        </form>
        <a href="{{ url_for('realizar_pedido') }}" class="btn-primario">Realizar Pedido</a>
    {% else %}
        <p>Tu carrito está vacío. <a href="{{ url_for('home') }}">Continúa comprando</a></p>
    {% endif %}
{% endblock %}